test:
  hosts:
    ansible-01:
      ansible_host: ansible-01
      ansible_ssh_user: ansible
      # haproxy_stats_auth:
      #   user: "user"
      #   password: "password"

      haproxy_frontends:
        - name: "http_frontend"
          address: "0.0.0.0"
          port: 80
          mode: "http"
          # default_backend: "default_backend"
          routes:
            - acl_name: "stats"
              acl_condition: "hdr(host) -i ansible-01"
              backend_name: "default_backend"

      haproxy_backends:
        - name: "default_backend"
          mode: "http"
          balance: "roundrobin"
          http_check:
            send:
              method: GET
              uri: /stats
            expect: "status 200"
          servers:
            - name: "default_server"
              address: "127.0.0.1"
              port: 9000
            - name: "default_server2"
              address: "127.0.0.1"
              ssl_enable: true
              verify: "none"
              backup: true
              port: 9000
